<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg viewBox="0 0 780 530" width="206mm" height="140mm" version="1.1"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
  <defs>
    <!-- Premium Gradients -->
    <linearGradient id="bgGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#fafbfc" />
      <stop offset="100%" stop-color="#f1f5f9" />
    </linearGradient>
    
    <linearGradient id="diskGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#64748b" />
      <stop offset="50%" stop-color="#475569" />
      <stop offset="100%" stop-color="#334155" />
    </linearGradient>
    
    <linearGradient id="rank0Grad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#f59e0b" />
      <stop offset="100%" stop-color="#d97706" />
    </linearGradient>
    
    <linearGradient id="barrierGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#22c55e" />
      <stop offset="100%" stop-color="#16a34a" />
    </linearGradient>
    
    <linearGradient id="workerGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#14b8a6" />
      <stop offset="100%" stop-color="#0d9488" />
    </linearGradient>
    
    <linearGradient id="memmapGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#0ea5e9" />
      <stop offset="100%" stop-color="#0284c7" />
    </linearGradient>
    
    <linearGradient id="osGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#22c55e" />
      <stop offset="100%" stop-color="#16a34a" />
    </linearGradient>
    
    <linearGradient id="criticalGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#f87171" />
      <stop offset="100%" stop-color="#ef4444" />
    </linearGradient>
    
    <linearGradient id="gpuGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#a78bfa" />
      <stop offset="50%" stop-color="#8b5cf6" />
      <stop offset="100%" stop-color="#7c3aed" />
    </linearGradient>
    
    <linearGradient id="pageLoadedGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#7dd3fc" />
      <stop offset="100%" stop-color="#38bdf8" />
    </linearGradient>
    
    <linearGradient id="cardGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#ffffff" />
      <stop offset="100%" stop-color="#f8fafc" />
    </linearGradient>
    
    <!-- Refined Arrow Markers -->
    <marker id="arrowGray" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,1 L10,4 L0,7 L2,4 Z" fill="#64748b" />
    </marker>
    
    <marker id="arrowBlue" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,1 L10,4 L0,7 L2,4 Z" fill="#0284c7" />
    </marker>
    
    <marker id="arrowPurple" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,1 L10,4 L0,7 L2,4 Z" fill="#7c3aed" />
    </marker>
    
    <marker id="arrowOrange" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,1 L10,4 L0,7 L2,4 Z" fill="#d97706" />
    </marker>
    
    <marker id="arrowGreen" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,1 L10,4 L0,7 L2,4 Z" fill="#16a34a" />
    </marker>
  </defs>
  
  <!-- Premium Background -->
  <rect x="0" y="0" width="780" height="530" fill="url(#bgGrad)" />
  
  <!-- Decorative background elements -->
  <circle cx="700" cy="80" r="120" fill="#0ea5e9" fill-opacity="0.03" />
  <circle cx="80" cy="450" r="100" fill="#8b5cf6" fill-opacity="0.03" />
  <circle cx="400" cy="280" r="180" fill="#22c55e" fill-opacity="0.02" />
  
  <!-- ==================== HEADER ==================== -->
  <g transform="translate(390, 35)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#0f172a" text-anchor="middle" letter-spacing="0.5">Memory-Mapped Data Pipeline</text>
    <text x="0" y="22" font-family="Arial, sans-serif" font-size="11" fill="#64748b" text-anchor="middle">Zero-Copy I/O with Distributed Data Parallel Synchronization</text>
    <line x1="-120" y1="32" x2="120" y2="32" stroke="#e2e8f0" stroke-width="2" stroke-linecap="round"/>
  </g>
  
  <!-- ==================== SECTION 1: DISK STORAGE ==================== -->
  <g transform="translate(30, 85)">
    <!-- 3D Disk cylinder with premium look -->
    <ellipse cx="55" cy="22" rx="50" ry="14" fill="#94a3b8" />
    <ellipse cx="55" cy="20" rx="50" ry="14" fill="url(#diskGrad)" />
    
    <rect x="5" y="20" width="100" height="80" fill="url(#diskGrad)" />
    <path d="M5,20 L5,100" stroke="#334155" stroke-width="1" />
    <path d="M105,20 L105,100" stroke="#1e293b" stroke-width="1" />
    
    <ellipse cx="55" cy="100" rx="50" ry="14" fill="#1e293b" />
    
    <!-- Inner disk detail -->
    <ellipse cx="55" cy="20" rx="35" ry="9" fill="#475569" fill-opacity="0.4" />
    <ellipse cx="55" cy="20" rx="10" ry="4" fill="#94a3b8" />
    
    <!-- File icon on disk -->
    <g transform="translate(30, 45)">
      <rect x="0" y="0" width="50" height="40" rx="4" fill="#ffffff" stroke="#94a3b8" stroke-width="1"/>
      <path d="M35,0 L50,0 L50,15 L35,15 Z" fill="#e2e8f0"/>
      <path d="M35,0 L35,15 L50,15" fill="none" stroke="#94a3b8" stroke-width="1"/>
      
      <!-- File lines -->
      <line x1="8" y1="12" x2="28" y2="12" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
      <line x1="8" y1="20" x2="38" y2="20" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
      <line x1="8" y1="28" x2="32" y2="28" stroke="#94a3b8" stroke-width="2" stroke-linecap="round"/>
    </g>
    
    <!-- Labels -->
    <text x="55" y="138" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#334155" text-anchor="middle">Disk Storage</text>
    <rect x="10" y="148" width="90" height="22" rx="11" fill="#f1f5f9" stroke="#e2e8f0" stroke-width="1"/>
    <text x="55" y="163" font-family="Consolas, monospace" font-size="9" fill="#64748b" text-anchor="middle">train_data.npz</text>
    <text x="55" y="185" font-family="Arial, sans-serif" font-size="10" fill="#94a3b8" text-anchor="middle">100GB+ Dataset</text>
  </g>
  
  <!-- Arrow: Disk -> Rank 0 -->
  <path d="M145,175 Q170,175 195,175" stroke="#64748b" stroke-width="2.5" fill="none" marker-end="url(#arrowGray)" stroke-linecap="round"/>
  
  <!-- ==================== SECTION 2: RANK 0 PROCESSING ==================== -->
  <g transform="translate(210, 90)">
    <!-- Card with subtle shadow -->
    <rect x="2" y="2" width="176" height="170" rx="12" fill="#94a3b8" fill-opacity="0.15" />
    <rect x="0" y="0" width="176" height="170" rx="12" fill="url(#cardGrad)" stroke="#fcd34d" stroke-width="1.5"/>
    
    <!-- Rank 0 badge -->
    <rect x="38" y="-14" width="100" height="28" rx="14" fill="url(#rank0Grad)"/>
    <text x="88" y="6" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#ffffff" text-anchor="middle">Rank 0 Only</text>
    
    <!-- Step 1: Convert NPZ -->
    <g transform="translate(15, 30)">
      <rect x="0" y="0" width="146" height="55" rx="8" fill="#fffbeb" stroke="#f59e0b" stroke-width="1"/>
      
      <!-- Step number badge -->
      <circle cx="22" cy="27" r="14" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
      <text x="22" y="32" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#d97706" text-anchor="middle">1</text>
      
      <text x="88" y="22" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#92400e" text-anchor="middle">Convert NPZ</text>
      <text x="88" y="38" font-family="Consolas, monospace" font-size="8" fill="#64748b" text-anchor="middle">-&gt; Binary Memmap</text>
      <text x="88" y="50" font-family="Consolas, monospace" font-size="8" fill="#64748b" text-anchor="middle">(.dat file)</text>
    </g>
    
    <!-- Step 2: Fit Scaler -->
    <g transform="translate(15, 100)">
      <rect x="0" y="0" width="146" height="55" rx="8" fill="#fffbeb" stroke="#f59e0b" stroke-width="1"/>
      
      <!-- Step number badge -->
      <circle cx="22" cy="27" r="14" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
      <text x="22" y="32" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#d97706" text-anchor="middle">2</text>
      
      <text x="88" y="22" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#92400e" text-anchor="middle">Fit StandardScaler</text>
      <text x="88" y="38" font-family="Consolas, monospace" font-size="8" fill="#64748b" text-anchor="middle">mu, sigma from</text>
      <text x="88" y="50" font-family="Consolas, monospace" font-size="8" fill="#64748b" text-anchor="middle">train set only</text>
    </g>
  </g>
  
  <!-- Arrow: Rank 0 -> Barrier -->
  <path d="M395,175 Q420,175 445,175" stroke="#d97706" stroke-width="2.5" fill="none" marker-end="url(#arrowOrange)" stroke-linecap="round"/>
  
  <!-- ==================== SECTION 3: DDP BARRIER ==================== -->
  <g transform="translate(460, 105)">
    <!-- Barrier container -->
    <rect x="2" y="2" width="86" height="140" rx="10" fill="#94a3b8" fill-opacity="0.15" />
    <rect x="0" y="0" width="86" height="140" rx="10" fill="#f0fdf4" stroke="#86efac" stroke-width="1.5" stroke-dasharray="8,4"/>
    
    <!-- Sync symbol -->
    <g transform="translate(43, 50)">
      <!-- Rotating arrows symbol -->
      <circle cx="0" cy="0" r="25" fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
      <path d="M-10,-15 A18,18 0 0,1 15,0" fill="none" stroke="#16a34a" stroke-width="3" stroke-linecap="round"/>
      <path d="M10,15 A18,18 0 0,1 -15,0" fill="none" stroke="#16a34a" stroke-width="3" stroke-linecap="round"/>
      <polygon points="15,0 15,-8 23,0" fill="#16a34a"/>
      <polygon points="-15,0 -15,8 -23,0" fill="#16a34a"/>
    </g>
    
    <!-- Waiting processes -->
    <g transform="translate(18, 95)">
      <circle cx="10" cy="8" r="5" fill="#22c55e"/>
      <circle cx="25" cy="8" r="5" fill="#22c55e"/>
      <circle cx="40" cy="8" r="5" fill="#22c55e"/>
      <line x1="10" y1="8" x2="40" y2="8" stroke="#22c55e" stroke-width="2" stroke-dasharray="3,3"/>
    </g>
    
    <text x="43" y="128" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#15803d" text-anchor="middle">Barrier</text>
    <text x="43" y="148" font-family="Consolas, monospace" font-size="7" fill="#64748b" text-anchor="middle">wait_for_everyone()</text>
  </g>
  
  <!-- Arrow: Barrier -> Workers -->
  <path d="M555,175 Q580,175 605,175" stroke="#16a34a" stroke-width="2.5" fill="none" marker-end="url(#arrowGreen)" stroke-linecap="round"/>
  
  <!-- ==================== SECTION 4: DATALOADER WORKERS ==================== -->
  <g transform="translate(620, 80)">
    <!-- Main container with shadow -->
    <rect x="2" y="2" width="138" height="195" rx="12" fill="#94a3b8" fill-opacity="0.15" />
    <rect x="0" y="0" width="138" height="195" rx="12" fill="url(#cardGrad)" stroke="#5eead4" stroke-width="1.5"/>
    
    <!-- Header badge -->
    <rect x="19" y="-14" width="100" height="28" rx="14" fill="url(#workerGrad)"/>
    <text x="69" y="6" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#ffffff" text-anchor="middle">All Ranks</text>
    
    <!-- Workers grid -->
    <g transform="translate(15, 28)">
      <!-- Worker 0 -->
      <rect x="0" y="0" width="50" height="45" rx="6" fill="#f0fdfa" stroke="#14b8a6" stroke-width="1"/>
      <text x="25" y="18" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="#0f766e" text-anchor="middle">Worker 0</text>
      <text x="25" y="34" font-family="Consolas, monospace" font-size="7" fill="#64748b" text-anchor="middle">handle_0</text>
      
      <!-- Worker 1 -->
      <rect x="58" y="0" width="50" height="45" rx="6" fill="#f0fdfa" stroke="#14b8a6" stroke-width="1"/>
      <text x="83" y="18" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="#0f766e" text-anchor="middle">Worker 1</text>
      <text x="83" y="34" font-family="Consolas, monospace" font-size="7" fill="#64748b" text-anchor="middle">handle_1</text>
      
      <!-- Worker N -->
      <rect x="29" y="52" width="50" height="45" rx="6" fill="#f0fdfa" stroke="#14b8a6" stroke-width="1"/>
      <text x="54" y="70" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="#0f766e" text-anchor="middle">Worker N</text>
      <text x="54" y="86" font-family="Consolas, monospace" font-size="7" fill="#64748b" text-anchor="middle">handle_n</text>
    </g>
    
    <!-- Explanation box -->
    <g transform="translate(12, 130)">
      <rect x="0" y="0" width="114" height="50" rx="6" fill="#ccfbf1" stroke="#2dd4bf" stroke-width="1"/>
      
      <!-- Lock Icon -->
      <rect x="12" y="18" width="14" height="12" rx="2" fill="#0d9488"/>
      <path d="M14,18 L14,14 A5,5 0 0,1 24,14 L24,18" fill="none" stroke="#0d9488" stroke-width="2.5" stroke-linecap="round"/>
      
      <text x="70" y="20" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="#0f766e" text-anchor="middle">Lazy Init</text>
      <text x="70" y="34" font-family="Arial, sans-serif" font-size="7" fill="#475569" text-anchor="middle">Own handle after</text>
      <text x="70" y="44" font-family="Consolas, monospace" font-size="7" fill="#475569" text-anchor="middle">fork()</text>
    </g>
  </g>
  
  <!-- ==================== SECTION 5: VIRTUAL MEMORY ==================== -->
  <g transform="translate(30, 305)">
    <!-- Large container with shadow -->
    <rect x="2" y="2" width="456" height="150" rx="14" fill="#94a3b8" fill-opacity="0.15" />
    <rect x="0" y="0" width="456" height="150" rx="14" fill="#e0f2fe" stroke="#7dd3fc" stroke-width="1.5"/>
    
    <!-- Header -->
    <rect x="128" y="-14" width="200" height="28" rx="14" fill="url(#memmapGrad)"/>
    <text x="228" y="6" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#ffffff" text-anchor="middle">Virtual Memory Space</text>
    
    <!-- Memory Pages Grid -->
    <g transform="translate(20, 28)">
      <!-- Row 1 -->
      <rect x="0" y="0" width="55" height="42" rx="4" fill="url(#pageLoadedGrad)" stroke="#0284c7" stroke-width="1.5"/>
      <text x="27.5" y="16" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="#ffffff" text-anchor="middle">Page 0</text>
      <rect x="10" y="24" width="35" height="12" rx="6" fill="#0284c7"/>
      <text x="27.5" y="33" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="#ffffff" text-anchor="middle">LOADED</text>
      
      <rect x="62" y="0" width="55" height="42" rx="4" fill="#f0f9ff" stroke="#bae6fd" stroke-width="1" stroke-dasharray="4,2"/>
      <text x="89.5" y="16" font-family="Arial, sans-serif" font-size="8" fill="#0369a1" text-anchor="middle">Page 1</text>
      <text x="89.5" y="32" font-family="Consolas, monospace" font-size="7" fill="#64748b" text-anchor="middle">on disk</text>
      
      <rect x="124" y="0" width="55" height="42" rx="4" fill="url(#pageLoadedGrad)" stroke="#0284c7" stroke-width="1.5"/>
      <text x="151.5" y="16" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="#ffffff" text-anchor="middle">Page 2</text>
      <rect x="134" y="24" width="35" height="12" rx="6" fill="#0284c7"/>
      <text x="151.5" y="33" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="#ffffff" text-anchor="middle">LOADED</text>
      
      <rect x="186" y="0" width="55" height="42" rx="4" fill="#f0f9ff" stroke="#bae6fd" stroke-width="1" stroke-dasharray="4,2"/>
      <text x="213.5" y="16" font-family="Arial, sans-serif" font-size="8" fill="#0369a1" text-anchor="middle">Page 3</text>
      <text x="213.5" y="32" font-family="Consolas, monospace" font-size="7" fill="#64748b" text-anchor="middle">on disk</text>
      
      <!-- Row 2 -->
      <rect x="0" y="50" width="55" height="42" rx="4" fill="#f0f9ff" stroke="#bae6fd" stroke-width="1" stroke-dasharray="4,2"/>
      <text x="27.5" y="66" font-family="Arial, sans-serif" font-size="8" fill="#0369a1" text-anchor="middle">Page 4</text>
      <text x="27.5" y="82" font-family="Consolas, monospace" font-size="7" fill="#64748b" text-anchor="middle">on disk</text>
      
      <rect x="62" y="50" width="55" height="42" rx="4" fill="#f0f9ff" stroke="#bae6fd" stroke-width="1" stroke-dasharray="4,2"/>
      <text x="89.5" y="66" font-family="Arial, sans-serif" font-size="8" fill="#0369a1" text-anchor="middle">Page 5</text>
      <text x="89.5" y="82" font-family="Consolas, monospace" font-size="7" fill="#64748b" text-anchor="middle">on disk</text>
      
      <text x="152" y="72" font-family="Arial, sans-serif" font-size="20" fill="#64748b" text-anchor="middle">...</text>
      
      <rect x="186" y="50" width="55" height="42" rx="4" fill="url(#pageLoadedGrad)" stroke="#0284c7" stroke-width="1.5"/>
      <text x="213.5" y="66" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="#ffffff" text-anchor="middle">Page N</text>
      <rect x="196" y="74" width="35" height="12" rx="6" fill="#0284c7"/>
      <text x="213.5" y="83" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="#ffffff" text-anchor="middle">LOADED</text>
    </g>
    
    <!-- OS Management Box -->
    <g transform="translate(280, 20)">
      <rect x="0" y="0" width="160" height="118" rx="10" fill="#ffffff" stroke="#22c55e" stroke-width="1.5"/>
      
      <!-- Header -->
      <rect x="30" y="-10" width="100" height="20" rx="10" fill="url(#osGrad)"/>
      <text x="80" y="5" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#ffffff" text-anchor="middle">OS Manages</text>
      
      <!-- Features list -->
      <g transform="translate(15, 22)">
        <rect x="0" y="0" width="130" height="26" rx="5" fill="#dcfce7"/>
        <circle cx="15" cy="13" r="9" fill="#22c55e"/>
        <text x="15" y="17" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#ffffff" text-anchor="middle">1</text>
        <text x="80" y="17" font-family="Arial, sans-serif" font-size="9" fill="#166534" text-anchor="middle">Page Faults</text>
      </g>
      
      <g transform="translate(15, 52)">
        <rect x="0" y="0" width="130" height="26" rx="5" fill="#dcfce7"/>
        <circle cx="15" cy="13" r="9" fill="#22c55e"/>
        <text x="15" y="17" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#ffffff" text-anchor="middle">2</text>
        <text x="80" y="17" font-family="Arial, sans-serif" font-size="9" fill="#166534" text-anchor="middle">LRU Eviction</text>
      </g>
      
      <g transform="translate(15, 82)">
        <rect x="0" y="0" width="130" height="26" rx="5" fill="#dcfce7"/>
        <circle cx="15" cy="13" r="9" fill="#22c55e"/>
        <text x="15" y="17" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#ffffff" text-anchor="middle">3</text>
        <text x="80" y="17" font-family="Arial, sans-serif" font-size="9" fill="#166534" text-anchor="middle">Prefetching</text>
      </g>
    </g>
  </g>
  
  <!-- Curved Arrow: Workers -> Virtual Memory -->
  <path d="M690,280 C690,320 600,330 430,320" stroke="#0284c7" stroke-width="2.5" fill="none" marker-end="url(#arrowBlue)" stroke-dasharray="8,4" stroke-linecap="round"/>
  <rect x="510" y="290" width="100" height="20" rx="10" fill="#e0f2fe" stroke="#7dd3fc" stroke-width="1"/>
  <text x="560" y="304" font-family="Consolas, monospace" font-size="9" fill="#0284c7" text-anchor="middle">np.memmap()</text>
  
  <!-- ==================== SECTION 6: CRITICAL OPERATION ==================== -->
  <g transform="translate(505, 340)">
    <rect x="2" y="2" width="140" height="105" rx="10" fill="#94a3b8" fill-opacity="0.15" />
    <rect x="0" y="0" width="140" height="105" rx="10" fill="#fef2f2" stroke="#fca5a5" stroke-width="2"/>
    
    <!-- Warning icon -->
    <g transform="translate(70, 25)">
      <circle cx="0" cy="0" r="18" fill="url(#criticalGrad)"/>
      <polygon points="0,-10 9,7 -9,7" fill="none" stroke="#ffffff" stroke-width="2" stroke-linejoin="round"/>
      <line x1="0" y1="-4" x2="0" y2="2" stroke="#ffffff" stroke-width="2.5" stroke-linecap="round"/>
      <circle cx="0" cy="5" r="1.5" fill="#ffffff"/>
    </g>
    
    <text x="70" y="58" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#dc2626" text-anchor="middle">Critical Step</text>
    
    <rect x="25" y="68" width="90" height="26" rx="6" fill="#ffffff" stroke="#ef4444" stroke-width="1.5"/>
    <text x="70" y="86" font-family="Consolas, monospace" font-size="13" font-weight="bold" fill="#dc2626" text-anchor="middle">.copy()</text>
  </g>
  
  <!-- Arrow: Critical -> GPU -->
  <path d="M655,390 Q685,390 715,390" stroke="#7c3aed" stroke-width="2.5" fill="none" marker-end="url(#arrowPurple)" stroke-linecap="round"/>
  
  <!-- ==================== SECTION 7: GPU ==================== -->
  <g transform="translate(690, 330)">
    <rect x="0" y="0" width="70" height="120" rx="10" fill="url(#gpuGrad)"/>
    
    <!-- GPU chip design -->
    <rect x="10" y="15" width="50" height="40" rx="4" fill="#a78bfa" stroke="#c4b5fd" stroke-width="1"/>
    
    <!-- Cores grid -->
    <g transform="translate(15, 20)">
      <rect x="0" y="0" width="12" height="10" rx="2" fill="#ffffff" fill-opacity="0.9"/>
      <rect x="14" y="0" width="12" height="10" rx="2" fill="#ffffff" fill-opacity="0.9"/>
      <rect x="28" y="0" width="12" height="10" rx="2" fill="#ffffff" fill-opacity="0.9"/>
      <rect x="0" y="12" width="12" height="10" rx="2" fill="#ffffff" fill-opacity="0.9"/>
      <rect x="14" y="12" width="12" height="10" rx="2" fill="#ffffff" fill-opacity="0.9"/>
      <rect x="28" y="12" width="12" height="10" rx="2" fill="#ffffff" fill-opacity="0.9"/>
    </g>
    
    <text x="35" y="72" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ffffff" text-anchor="middle">GPU</text>
    
    <rect x="10" y="82" width="50" height="28" rx="5" fill="#7c3aed" stroke="#a78bfa" stroke-width="1"/>
    <text x="35" y="95" font-family="Arial, sans-serif" font-size="8" fill="#e9d5ff" text-anchor="middle">Training</text>
    <text x="35" y="106" font-family="Arial, sans-serif" font-size="8" fill="#e9d5ff" text-anchor="middle">Batch</text>
  </g>
  
  <!-- ==================== FOOTER: Key Benefits ==================== -->
  <g transform="translate(30, 475)">
    <rect x="2" y="2" width="726" height="46" rx="10" fill="#94a3b8" fill-opacity="0.1" />
    <rect x="0" y="0" width="726" height="46" rx="10" fill="#ffffff" stroke="#e2e8f0" stroke-width="1"/>
    
    <!-- Benefit 1 -->
    <g transform="translate(18, 8)">
      <rect x="0" y="0" width="165" height="30" rx="8" fill="#e0f2fe" stroke="#7dd3fc" stroke-width="1"/>
      <text x="82.5" y="14" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#0369a1" text-anchor="middle">O(1) RAM Usage</text>
      <text x="82.5" y="26" font-family="Arial, sans-serif" font-size="7" fill="#64748b" text-anchor="middle">~2GB for 100GB+ dataset</text>
    </g>
    
    <!-- Benefit 2 -->
    <g transform="translate(198, 8)">
      <rect x="0" y="0" width="165" height="30" rx="8" fill="#ccfbf1" stroke="#5eead4" stroke-width="1"/>
      <text x="82.5" y="14" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#0f766e" text-anchor="middle">Zero-Copy Access</text>
      <text x="82.5" y="26" font-family="Arial, sans-serif" font-size="7" fill="#64748b" text-anchor="middle">No intermediate buffers</text>
    </g>
    
    <!-- Benefit 3 -->
    <g transform="translate(378, 8)">
      <rect x="0" y="0" width="165" height="30" rx="8" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
      <text x="82.5" y="14" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#b45309" text-anchor="middle">DDP-Safe</text>
      <text x="82.5" y="26" font-family="Arial, sans-serif" font-size="7" fill="#64748b" text-anchor="middle">Rank 0 creates, others wait</text>
    </g>
    
    <!-- Benefit 4 -->
    <g transform="translate(558, 8)">
      <rect x="0" y="0" width="150" height="30" rx="8" fill="#ede9fe" stroke="#c4b5fd" stroke-width="1"/>
      <text x="75" y="14" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#6d28d9" text-anchor="middle">Thread-Safe</text>
      <text x="75" y="26" font-family="Arial, sans-serif" font-size="7" fill="#64748b" text-anchor="middle">Per-worker handles</text>
    </g>
  </g>
</svg>
